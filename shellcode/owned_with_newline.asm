; Author: Abhinav Thakur
; Email : compilepeace@gmail.com
; Description : This shellcode prints "Owned!!" after it gets executed.


global _start


section .text

_start:


get_string:
	jmp push_string


main:

	; ssize_t write(int fd, const void *buf, size_t count)
	xor	eax, eax 		; Zero out eax
	mov ebx, eax		; Zeroing out ebx, ecx, edx
	mov ecx, eax
	mov edx, eax
	mov al, 0x4			; syscall number for write()
	mov	bl, 0x2			; set file descriptor to STDOUT (2)
	pop ecx				; counter to address of message text
	mov dl, 0x28		; data register to length of message
	int 0x80		


	; void _Exit(int status);
	xor eax, eax		; Zero out eax 
	mov ebx, eax		; Exit status
	mov al, 0x1			; syscall number for exit()
	int 0x80


push_string:
	call main
	msg:	db 0x0a, 0x0a, "~~~~Owned~~~~by~~~~0xDarkMagician~~~~", 0x0a, 0x0a

